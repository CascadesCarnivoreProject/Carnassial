<Window x:Class="Carnassial.CarnassialWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:controls="clr-namespace:Carnassial.Controls"
    xmlns:images="clr-namespace:Carnassial.Images"
    xmlns:local="clr-namespace:Carnassial"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    xmlns:xcad="http://schemas.xceed.com/wpf/xaml/avalondock"
    AutomationProperties.AutomationId="Carnassial"
    Loaded="Window_Loaded" Closing="Window_Closing" PreviewKeyDown="Window_PreviewKeyDown" 
    Height="900" Width="1350"
    WindowState="Normal" Icon="32x32.ico">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        
        <!-- Menu Bar -->
        <Menu Grid.Row="0">
            <!-- File Menu -->
            <MenuItem Header="_File" SubmenuOpened="File_SubmenuOpening">
                <MenuItem Name="MenuItemLoadImages" Header="_Load template, images, and video files..." Click="MenuItemLoadImages_Click" ToolTip="Asks for the template location, and then opens an existing database, or creates a new database after asking for the image/video locations"/>
                <MenuItem Name="MenuItemRecentImageSets" Header="Load a _recently used image set" IsEnabled="False" ToolTip="Load a recently used image set into Carnassial." />
                <MenuItem Name="MenuItemAddImagesToImageSet" Header="_Add image and video files to image set..." Click="MenuItemAddImagesToImageSet_Click" IsEnabled="False" ToolTip="Add more images or videos to the currently opened image set." />
                <Separator />
                <MenuItem Name="MenuItemExportAsCsv" Header="Export data for this image set as a _CSV file..." IsEnabled="False" Click="MenuItemExportCsv_Click" ToolTip="Exports data for the selected images into a CSV (comma separated value) file." />
                <MenuItem Name="MenuItemExportAsCsvAndPreview" Header="Export data for this image set as a CSV file and preview in _Excel..." IsEnabled="False" Click="MenuItemExportCsv_Click" ToolTip="Exports data for the selected files in the image set into a CSV (comma separated value) file and previews it in Excel." />
                <MenuItem Name="MenuItemImportFromCsv" Header="I_mport data from a CSV file..." IsEnabled="False" Click="MenuItemImportFromCsv_Click" ToolTip="Exports data for the selected files in the image set into a CSV (comma separated value) file." />
                <Separator />
                <MenuItem Name="MenuItemExportThisImage" Header="Export the current image or video _file..." Click="MenuItemExportThisImage_Click" IsEnabled="False" ToolTip="Exports (copies) the displayed image or video file into a location of your choosing." />
                <Separator />
                <MenuItem Name="MenuItemRenameFileDatabaseFile" Header="Rename the _data file..." Click="MenuItemRenameFileDatabaseFile_Click" IsEnabled="False" ToolTip="Renames the data file to a name of your choosing." />
                <Separator />
                <MenuItem Name="MenuItemExit" Header="E_xit" Click="MenuItemExit_Click" ToolTip="Quits the program"/>
            </MenuItem>

            <!-- Edit Menu -->
            <MenuItem Name="MenuItemEdit" Header="_Edit" IsEnabled="False">
                <MenuItem Name="MenuItemCopyPreviousValues" Header="_Copy previous values" Click="CopyPreviousValues_Click" InputGestureText="C" ToolTip="Copy selected data as recorded on the previous file. Applies only to data marked 'Copyable' in the template." />
                <MenuItem Name="MenuItemPopulateFieldFromMetadata" Header="Populate a field with _metadata..." ToolTip="Match a data field with a metadata type. Then populate that field across all files with the corresponding metadata value." Click="MenuItemPopulateFieldFromMetadata_Click" />
                <MenuItem Header="D_elete"  SubmenuOpened="Delete_SubmenuOpening">
                    <MenuItem Name="MenuItemDeleteCurrentFile" Header="The current current image or video _file..." Click="MenuItemDeleteImages_Click"  ToolTip="Deletes the file but not the data entered for it." />
                    <MenuItem Name="MenuItemDeleteCurrentFileAndData" Header="The current image or video file and its _data..." Click="MenuItemDeleteImages_Click"  ToolTip="Deletes the file and the data entered for it." />
                    <Separator/>
                    <MenuItem Name="MenuItemDeleteFiles" Header="_All image or video files in the current selection marked for deletion ..." Click="MenuItemDeleteImages_Click"  ToolTip="Deletes images and videos marked for deletion in the current selection, but leaves entered data intact." />
                    <MenuItem Name="MenuItemDeleteFilesAndData" Header="All image or video files in the _current selection marked for deletion and their data..." Click="MenuItemDeleteImages_Click"  ToolTip="Deletes images and videos marked for deletion in the current selection, as well as data entered for those files." />
                </MenuItem>
                <MenuItem Header="_Dates and times" >
                    <MenuItem Name="MenuItemRereadDateTimesfromFiles" Header="_Reread date/times from files..." Click="MenuItemRereadDateTimesFromFiles_Click"  ToolTip="Reread dates and times from all selected files." />
                    <MenuItem Name="MenuItemDaylightSavingsTimeCorrection" Header="Adjust for _daylight savings time..." Click="MenuItemDaylightSavingsTimeCorrection_Click"  ToolTip="Correct daylight saving time issues" />
                    <MenuItem Name="MenuItemDateTimeFixedCorrection" Header="Add a _fixed correction value to every date/time..." Click="MenuItemDateTimeFixedCorrection_Click"  ToolTip="Correct for dates or times which are all off by a fixed amount, which happens if your camera was not set to the correct date/time." />
                    <MenuItem Name="MenuItemDateTimeLinearCorrection" Header="Correct for camera cloc_k drift..." Click="MenuItemDateTimeLinearCorrection_Click"  ToolTip="Correct for a camera's clock running fast or slow." />
                    <MenuItem Name="MenuItemModifyAmbiguousDates" Header="Correct for _ambiguous dates..." Click="MenuItemCorrectAmbiguousDates_Click"  ToolTip="Check and optionally correct ambiguous dates (day-month vs month-day)." />
                    <MenuItem Name="MenuItemSetTimeZone" Header="Set time _zone..." Click="MenuItemSetTimeZone_Click" ToolTip="Reassign the selected files to a particular time zone." />
                </MenuItem>
                <MenuItem Name="MenuItemOptionsDarkImagesThreshold" Header="Identify or reclassify dar_k files..." Click="MenuItemOptionsDarkImages_Click" ToolTip="Determine which files are dark and light or reclassify your files." />
                <MenuItem Name="MenuItemLog" Header="Edit _notes for this image set..." Click="MenuItemLog_Click"  ToolTip="View and edit any notes (e.g., a log of activites or to-do items) particular to this image set" />
            </MenuItem>

            <!-- Options Menu -->
            <MenuItem Name="MenuItemOptions" Header="_Options" IsEnabled="False">
                <MenuItem Name="MenuItemSkipDarkFileCheck" IsCheckable="True" IsChecked="False" Header="_Skip dark check when adding files" Click="MenuItemSkipDarkFileCheck_Click" ToolTip="Make adding files to an image set faster by not checking if they're dark.  They can be checked for dark later through the Edit menu." />
                <MenuItem Name="MenuItemOrderFilesByDateTime" IsCheckable="True" IsChecked="False" Header="_Order files by date/time" Click="MenuItemOrderFilesByDateTime_Click" ToolTip="Sort files by their date/time rather than the order in which they were added to the image set." />
                <MenuItem Name="MenuItemAudioFeedback" IsCheckable="True" IsChecked="False" IsEnabled="False" Header="_Audio feedback" Click="MenuItemAudioFeedback_Click" ToolTip="Toggles the audio that speaks the count whenever you add a counting mark to the image." />
                <Separator/>
                <MenuItem Name="MenuItemDialogsOnOrOff" Header="Turn _dialogs on or off" IsEnabled="False">
                    <MenuItem Name="MenuItemEnableAmbiguousDatesDialog" IsCheckable="True" Header="Display _ambiguous dates imported dialog" Click="MenuItemAmbiguousDatesDialog_Click" ToolTip="Turn on or off the informational dialog displayed when files with ambiguous dates are added to an image set." />
                    <MenuItem Name="MenuItemEnableSelectedAmbiguousDatesPrompt" IsCheckable="True" Header="Display _ambiguous dates subset prompt" Click="MenuItemEnableSelectedAmbiguousDatesPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when ambiguous date clarification is performed when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableFileCountOnImportDialog" IsCheckable="True" Header="Display _counts when files are added" Click="MenuItemEnableFileCountOnImportDialog_Click" ToolTip="Turn on or off the informational dialog displaying image counts when files are loaded into an image set." />
                    <MenuItem Name="MenuItemEnableSelectedDateTimeLinearCorrectionPrompt" IsCheckable="True" Header="Display _clock drift subset prompt" Click="MenuItemEnableSelectedDateTimeLinearCorrectionPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when clock drift correction is performed when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableCsvExportDialog" IsCheckable="True" Header="Display _CSV export dialog" Click="MenuItemEnableCsvExportDialog_Click" ToolTip="Turn on or off the informational dialog displayed when CSV files are exported." />
                    <MenuItem Name="MenuItemEnableSelectedCsvExportPrompt" IsCheckable="True" Header="Display _CSV export subset prompt" Click="MenuItemEnableSelectedCsvExportPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when CSV export is performed when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableCsvImportPrompt" IsCheckable="True" Header="Display _CSV import prompt" Click="MenuItemEnableCsvImportPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when a CSV file is imported." />
                    <MenuItem Name="MenuItemEnableSelectedDarkThresholdPrompt" IsCheckable="True" Header="Display dark _threshold subset prompt" Click="MenuItemEnableSelectedDarkThresholdPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when adjusting the dark threshold when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableSelectedDaylightSavingsCorrectionPrompt" IsCheckable="True" Header="Display _daylight savings correction subset prompt" Click="MenuItemEnableSelectedDaylightSavingsCorrectionPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when corrections for daylight savings time is performed when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableSelectedDateTimeFixedCorrectionPrompt" IsCheckable="True" Header="Display _fixed date/time correction subset prompt" Click="MenuItemEnableSelectedDateTimeFixedCorrectionPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when fixed date/time correction is performed when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableSelectedPopulateFieldFromMetadataPrompt" IsCheckable="True" Header="Display _metadata subset prompt" Click="MenuItemEnableSelectedPopulateFieldFromMetadataPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when metadata is read from when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableSelectedRereadDatesFromFilesPrompt" IsCheckable="True" Header="Display _reread dates subset prompt" Click="MenuItemEnableSelectedRereadDatesFromFilesPrompt_Click" ToolTip="Turn on or off the informational dialog displayed when dates are reloaded from files when only some of the image set is selected." />
                    <MenuItem Name="MenuItemEnableSelectedSetTimeZonePrompt" IsCheckable="True" Header="Display set time _zone subset prompt" Click="MenuItemEnableSelectedSetTimeZonePrompt_Click" ToolTip="Turn on or off the informational dialog displayed when time zones are assigned when only some of the image set is selected." />
                </MenuItem>
                <Separator/>
                <MenuItem Header="Ad_vanced">
                    <MenuItem Name="MenuItemOptionsBox" Header="_Image set options..." Click="MenuItemAdvancedImageSetOptions_Click" ToolTip="Image set configuration options that should only be used by advanced users."/>
                    <MenuItem Name="MenuItemAdvancedCarnassialOptions" Header="_Carnassial options..." Click="MenuItemAdvancedCarnassialOptions_Click" IsEnabled="False" ToolTip="Carnassial configuration options that should only be used by advanced users."/>
                </MenuItem>
            </MenuItem>

            <!-- View Menu -->
            <MenuItem Name="MenuItemView" Header="_View" IsEnabled="False"  ToolTip="Zooming, navigating, and image differencing.">
                <MenuItem Name="MenuItemShowNextFile" Header="View _next file" Click="MenuItemShowNextFile_Click" InputGestureText="&#x2192;" ToolTip="View the next file in the image set." />
                <MenuItem Name="MenuItemShowPreviousFile" Header="View _previous file" Click="MenuItemShowPreviousFile_Click" InputGestureText="&#x2190;" ToolTip="View the previous file in the image set." />
                <Separator />
                <MenuItem Name="MenuItemZoomIn" Header="Zoom _in" Click="MenuItemZoomIn_Click" InputGestureText="&#x2039;" ToolTip="Zoom into this file." />
                <MenuItem Name="MenuItemZoomOut" Header="Zoom _out" Click="MenuItemZoomOut_Click" InputGestureText="&#x203A;" ToolTip="Zoom out in this file." />
                <Separator />
                <MenuItem Name="MenuItemViewDifferencesCycleThrough" Header="_Cycle through image differences" Click="MenuItemViewDifferencesCycleThrough_Click" InputGestureText="&#x2191;" ToolTip="Show difference between the current and the next file, and then the current and the previous file." />
                <MenuItem Name="MenuItemViewDifferencesCombined" Header="_View combined image differences" Click="MenuItemViewDifferencesCombined_Click" InputGestureText="&#x2193;" ToolTip="Show the difference between the current image and the next and previous files simultaneously." />
                <Separator />
                <MenuItem Name="MenuItemDisplayMagnifier" IsCheckable="True" InputGestureText="M" Header="Display _magnifying glass on images" Click="MenuItemDisplayMagnifier_Click" ToolTip="Toggles the presence of the magnifying glass on image files.  The magnifying glass is not available on videos." />
                <MenuItem Name="MenuItemMagnifierIncrease" InputGestureText="U" Header="_Increase magnifying glass magnification" Click="MenuItemMagnifierIncrease_Click" ToolTip="Increase the magnification of the magnifying glass." />
                <MenuItem Name="MenuItemMagnifierDecrease" InputGestureText="D" Header="_Decrease magnifying glass magnification" Click="MenuItemMagnifierDecrease_Click" ToolTip="Decrease the magnification of the magnifying glass." />
                <Separator />
                <MenuItem Name="MenuItemBookmarkSavePanZoom" Header="_Bookmark current zoom region" InputGestureText="B" Click="MenuItemBookmarkSavePanZoom_Click" ToolTip="Save the current zoom region setting as a bookmark." />
                <MenuItem Name="MenuItemBookmarkSetPanZoom"  Header="Zoom to bookmarked _region" InputGestureText="+" Click="MenuItemBookmarkSetPanZoom_Click" ToolTip="Zoom to the region saved in the bookmark." />
                <MenuItem Name="MenuItemBookmarkDefaultPanZoom" Header="Zoom out all the _way" Click="MenuItemBookmarkDefaultPanZoom_Click" InputGestureText="-" ToolTip="Zoom out to see the entire image." />
            </MenuItem>

            <!-- Select menu -->
            <MenuItem Name="MenuItemSelect" Header="_Select" IsEnabled="False" SubmenuOpened="MenuItemSelect_SubmenuOpening" ToolTip="Select a subset of the files.">
                <MenuItem Name="MenuItemSelectAllFiles" IsCheckable="True" IsChecked="True" Header="_All files" Click="MenuItemSelectFiles_Click" ToolTip="Shows all files, including corrupted and dark ones." />
                <MenuItem Name="MenuItemSelectOkFiles" IsCheckable="True" IsChecked="False" Header="_Light files" Click="MenuItemSelectFiles_Click" ToolTip="Exlcudes dark, corrupted, or missing files." />
                <MenuItem Name="MenuItemSelectDarkFiles" IsCheckable="True" IsChecked="False" Header="_Dark files" Click="MenuItemSelectFiles_Click" ToolTip="Show only dark images." />
                <MenuItem Name="MenuItemSelectCorruptedFiles" IsCheckable="True" IsChecked="False" Header="_Corrupted files" Click="MenuItemSelectFiles_Click" ToolTip="Show only corrupted images." />
                <MenuItem Name="MenuItemSelectFilesNoLongerAvailable" IsCheckable="True" IsChecked="False" Header="_Missing files" Click="MenuItemSelectFiles_Click" ToolTip="Show records for files no longer available." />
                <MenuItem Name="MenuItemSelectFilesMarkedForDeletion" IsCheckable="True" IsChecked="False" Header="Files marked for d_eletion" Click="MenuItemSelectFiles_Click" ToolTip="Show only those marked for deletion." />
                <MenuItem Name="MenuItemSelectCustom" IsCheckable="True" IsChecked="False" Header="_Custom selection..." Click="MenuItemSelectCustomSelection_Click" ToolTip="Create a custom selection." />
                <Separator />
                <MenuItem Name="MenuItemImageCounts" Header="Show _file counts..." Click="MenuItemImageCounts_Click" ToolTip="Displays statistics on the number of files and their types." />
            </MenuItem>

            <!-- Help Menu -->
            <MenuItem Name="MenuItemHelp" Header="_Help">
                <MenuItem Name="MenuItemAbout" Header="_About..." Click="MenuItemAbout_Click" ToolTip="Displays version information about this program and how to contact the development team." />
            </MenuItem>
        </Menu>

        <xcad:DockingManager AllowMixedOrientation="True" BorderBrush="Black" BorderThickness="1" Grid.Row="1">
            <xcad:DockingManager.DocumentHeaderTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal">
                        <Image Source="{Binding IconSource}" Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding Title}" />
                    </StackPanel>
                </DataTemplate>
            </xcad:DockingManager.DocumentHeaderTemplate>
            <xcad:LayoutRoot x:Name="LayoutRoot">
                <xcad:LayoutPanel Orientation="Horizontal">
                    <xcad:LayoutDocumentPaneGroup>
                        <xcad:LayoutDocumentPane>
                            <!-- AvalonDock uses a fixed zero margin after uncloseable tab titles; fake a margin with some trailing spaces -->
                            <xcad:LayoutDocument x:Name="InstructionPane" Title="Instructions  " CanClose="False">
                                <controls:HelpUserControl AllowDrop="True" Drop="HelpDocument_Drop" PreviewDragEnter="HelpDocument_PreviewDrag" PreviewDragOver="HelpDocument_PreviewDrag" Height="Auto" />
                            </xcad:LayoutDocument>
                            <xcad:LayoutDocument x:Name="ImageSetPane" Title="Image set  " CanClose="False" >
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <controls:FeedbackControl x:Name="FeedbackControl" Grid.Row="0" Visibility="Collapsed" />
                                    <Slider Name="FileNavigatorSlider" Grid.Row="1" Minimum="0" Maximum="0" IsSnapToTickEnabled="True" TickFrequency="1" LargeChange="1" ToolTip="Scroll through all files" Margin="5,0,5,0"
                                            Thumb.DragStarted="ImageNavigatorSlider_DragStarted" 
                                            Thumb.DragCompleted="ImageNavigatorSlider_DragCompleted"
                                            ValueChanged="ImageNavigatorSlider_ValueChanged" />
                                    <images:MarkableCanvas x:Name="MarkableCanvas" Grid.Row="2" />
                                </Grid>
                            </xcad:LayoutDocument>
                            <xcad:LayoutDocument x:Name="DataGridPane" Title="Data grid  " CanClose="False" IsActiveChanged="DataGridPane_IsActiveChanged">
                                <DataGrid Name="DataGrid" MinHeight="100" MinWidth="100"  DockPanel.Dock="Top" HorizontalAlignment="Stretch" FontSize="12" VerticalScrollBarVisibility="Auto"/>
                            </xcad:LayoutDocument>
                        </xcad:LayoutDocumentPane>
                    </xcad:LayoutDocumentPaneGroup>
                    <xcad:LayoutAnchorablePaneGroup DockWidth="300">
                        <xcad:LayoutAnchorablePane>
                            <xcad:LayoutAnchorable Title="Data Entry" CanClose="False">
                                <Grid Name="ControlGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <!-- Controls Tray panel (to hold controls) -->
                                    <ScrollViewer Grid.Column="0" Grid.Row="0" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                        <StackPanel Name="ControlsPanel">
                                            <controls:DataEntryControls x:Name="DataEntryControls" />
                                        </StackPanel>
                                    </ScrollViewer>
                                    <Button Name="CopyPreviousValues" Click="CopyPreviousValues_Click" Margin="10,10,10,10" Padding="5,5,5,5" Grid.Column="0" Grid.Row="1" 
                                        HorizontalAlignment="Left" Content="_Copy previous values" IsEnabled="False"
                                        MouseEnter="CopyPreviousValues_MouseEnter" MouseLeave="CopyPreviousValues_MouseLeave"
                                        ToolTip="Copy the highlighted data (fields marked 'Copyable' in the template) from the previous file." />
                                </Grid>
                            </xcad:LayoutAnchorable>
                        </xcad:LayoutAnchorablePane>
                    </xcad:LayoutAnchorablePaneGroup>
                </xcad:LayoutPanel>
            </xcad:LayoutRoot>
        </xcad:DockingManager>

        <!-- Status bar -->
        <StatusBar Name="statusBar" ItemsSource="{Binding}" Grid.Row="2" Height="22">
            <StatusBarItem Content="File:" FontWeight="Bold" />
            <StatusBarItem Content="0"/>
            <StatusBarItem Content="of"/>
            <StatusBarItem Content="Unknown"/>
            <StatusBarItem Content=""/>
            <StatusBarItem Content="" HorizontalAlignment="Right" />
        </StatusBar>
    </Grid>
</Window>
